<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Primary SEO (Bilaad-style) -->
  <title>AMADA REALTY - Global Estate</title>
  <meta name="title" content="AMADA REALTY - Global Estate" />
  <meta name="description" content="Welcome to The Amada Advantage. Our homes are designed for more than just today — blending timeless architecture with private-city amenities. Explore The City, select an Asset, and request your PR Card dossier." />
  <meta name="robots" content="index,follow" />
  <meta name="keywords" content="Amada Realty, luxury estate, gated community, private city, premium real estate, Nigeria luxury homes, sustainable communities, masterplan, estate assets" />
  <meta name="theme-color" content="#0f172a" />
  <link rel="canonical" href="https://amadarealty.com/" />

  <!-- Social (Open Graph / Twitter) -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Amada Realty" />
  <meta property="og:title" content="AMADA REALTY - Global Estate" />
  <meta property="og:description" content="A private-city estate with curated territories and elite amenities. Select an Asset on the master layout and request your PR Card dossier." />
  <meta property="og:url" content="https://amadarealty.com/" />
  <meta property="og:image" content="https://images.unsplash.com/photo-1600607686527-6fb886090705?q=80&w=1600&auto=format&fit=crop" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="AMADA REALTY - Global Estate" />
  <meta name="twitter:description" content="Select an Asset on the master layout and request your PR Card dossier." />
  <meta name="twitter:image" content="https://images.unsplash.com/photo-1600607686527-6fb886090705?q=80&w=1600&auto=format&fit=crop" />

  <!-- Favicon (inline SVG) -->
  <link rel="icon" type="image/svg+xml"
        href='data:image/svg+xml;utf8,
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128">
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="%230f172a"/>
              <stop offset="1" stop-color="%23334155"/>
            </linearGradient>
          </defs>
          <rect width="128" height="128" rx="28" fill="url(%23g)"/>
          <path d="M64 18l30 26-12 48H46L34 44 64 18z" fill="%23ffffff" opacity="0.95"/>
          <path d="M64 18l30 26H34L64 18z" fill="%23ffffff" opacity="0.65"/>
          <path d="M46 92h36l-18 18-18-18z" fill="%23ffffff" opacity="0.85"/>
        </svg>'/>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600&family=Plus+Jakarta+Sans:wght@200;300;400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --glass-border: rgba(255,255,255,.42);
      --glass-shadow: 0 10px 30px rgba(15,23,42,.06);
    }
    body{
      font-family:'Plus Jakarta Sans',sans-serif;
      background:#f8fafc;
      color:#0f172a;
      overflow-x:hidden;
    }
    h1,h2,h3,h4,.serif{font-family:'Cormorant Garamond',serif;}

    /* SPA pages */
    .page{display:none;}
    .page.active{display:block;}

    /* Ambient background */
    .ambient-bg{
      position:fixed; inset:0;
      z-index:-1;
      background:
        radial-gradient(circle at 20% 20%, rgba(224,242,254,0.9), transparent 55%),
        radial-gradient(circle at 80% 30%, rgba(240,253,244,0.85), transparent 60%),
        radial-gradient(circle at 50% 80%, rgba(253,244,255,0.85), transparent 55%),
        linear-gradient(#ffffff, #f1f5f9);
      overflow:hidden;
    }
    .orb{
      position:absolute; border-radius:50%;
      filter:blur(90px);
      opacity:.55;
      animation:float 18s infinite ease-in-out;
    }
    .orb-1{width:520px;height:520px;background:#e0f2fe;top:-12%;left:-10%;animation-delay:0s;}
    .orb-2{width:460px;height:460px;background:#f0fdf4;bottom:-10%;right:-10%;animation-delay:-4s;}
    .orb-3{width:360px;height:360px;background:#fdf4ff;top:42%;left:44%;animation-delay:-8s;}
    @keyframes float{0%,100%{transform:translate(0,0);}50%{transform:translate(26px,-40px);}}

    /* Glass */
    .glass-panel{
      background:rgba(255,255,255,.68);
      backdrop-filter:blur(16px);
      -webkit-backdrop-filter:blur(16px);
      border:1px solid var(--glass-border);
      box-shadow:var(--glass-shadow);
    }
    .glass-card{
      background:rgba(255,255,255,.45);
      backdrop-filter:blur(10px);
      -webkit-backdrop-filter:blur(10px);
      border:1px solid rgba(255,255,255,.55);
      transition:transform .2s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease;
    }
    .glass-card:hover{
      background:rgba(255,255,255,.9);
      transform:translateY(-3px);
      box-shadow:0 18px 40px rgba(15,23,42,.08);
      border-color:rgba(255,255,255,.9);
    }

    /* Modals */
    .modal-overlay{opacity:0;pointer-events:none;transition:opacity .22s ease;}
    .modal-overlay.open{opacity:1;pointer-events:all;}
    .modal-content{transform:translateY(14px);transition:transform .22s ease;}
    .modal-overlay.open .modal-content{transform:translateY(0);}

    /* Marquee */
    .marquee-container{overflow:hidden;white-space:nowrap;}
    .marquee-content{display:inline-block;animation:scroll 28s linear infinite;}
    @keyframes scroll{0%{transform:translateX(0);}100%{transform:translateX(-50%);}}

    /* Reveal */
    .reveal{opacity:0;transform:translateY(18px);transition:all .8s ease-out;}
    .reveal.active{opacity:1;transform:translateY(0);}

    /* Tooltip */
    .tip{
      position:absolute;
      z-index:30;
      padding:8px 12px;
      border-radius:16px;
      background:rgba(15,23,42,.94);
      color:#fff;
      font-size:11px;
      letter-spacing:.16em;
      text-transform:uppercase;
      pointer-events:none;
      box-shadow:0 26px 60px rgba(2,6,23,.25);
      white-space:nowrap;
    }

    /* Estate mini layout (3D-ish) */
    .estate-canvas{
      position:relative;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(148,163,184,.35);
      background:
        radial-gradient(circle at 20% 30%, rgba(34,197,94,.18), transparent 55%),
        radial-gradient(circle at 70% 40%, rgba(34,197,94,.12), transparent 60%),
        linear-gradient(180deg, rgba(6,95,70,.14), rgba(34,197,94,.06));
    }
    .estate-inner{
      position:absolute; inset:0;
      background:
        repeating-linear-gradient(45deg, rgba(255,255,255,.02) 0 8px, rgba(0,0,0,.02) 8px 16px);
      mix-blend-mode:overlay;
      pointer-events:none;
    }

    /* Road */
    .estate-road{
      border-radius:14px;
      background:
        linear-gradient(180deg, rgba(15,23,42,.9), rgba(15,23,42,.78));
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,.08),
        0 10px 18px rgba(2,6,23,.08);
      position:relative;
    }
    .estate-road:before{
      content:"";
      position:absolute; inset:10px 45%;
      border-left:2px dashed rgba(255,255,255,.22);
      border-right:2px dashed rgba(255,255,255,.10);
      border-radius:999px;
      opacity:.9;
    }

    /* Territory band */
    .band{
      border-radius:16px;
      overflow:hidden;
      border:1px solid rgba(148,163,184,.35);
      background:
        linear-gradient(180deg, rgba(15,118,110,.10), rgba(2,132,199,.06));
      box-shadow:0 10px 18px rgba(2,6,23,.04);
    }
    .band-title{
      background:rgba(15,23,42,.72);
      color:white;
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      padding:10px 12px;
      font-weight:700;
      text-align:center;
    }
    .lots{
      padding:10px;
      background:
        linear-gradient(180deg, rgba(2,132,199,.14), rgba(2,132,199,.08));
    }

    /* Unit square (tiny, fast) */
    .unit{
      width:24px; height:24px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,.7);
      box-shadow:
        0 6px 10px rgba(2,6,23,.06),
        inset 0 1px 0 rgba(255,255,255,.35);
      position:relative;
      transform:translateZ(0);
      transition:transform .12s ease, opacity .12s ease, box-shadow .12s ease;
    }
    .unit:hover{transform:translateY(-1px);opacity:.98;box-shadow:0 10px 18px rgba(2,6,23,.12), inset 0 1px 0 rgba(255,255,255,.38);}
    .unit:focus{outline:none; box-shadow:0 0 0 3px rgba(15,23,42,.18), 0 10px 18px rgba(2,6,23,.10), inset 0 1px 0 rgba(255,255,255,.38);}
    .unit:after{
      /* tiny roof highlight for “3D house feel” */
      content:"";
      position:absolute; left:5px; top:5px;
      width:14px; height:14px;
      background:rgba(255,255,255,.22);
      clip-path:polygon(50% 0, 100% 38%, 100% 100%, 0 100%, 0 38%);
      border-radius:3px;
      opacity:.75;
      pointer-events:none;
    }

    /* Amenity stack */
    .amenity{
      border-radius:16px;
      border:1px solid rgba(148,163,184,.35);
      background:rgba(255,255,255,.55);
      box-shadow:0 10px 18px rgba(2,6,23,.05);
      overflow:hidden;
    }
    .amenity-pill{
      border-radius:999px;
      background:rgba(15,23,42,.90);
      color:white;
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      font-weight:800;
      padding:14px 12px;
      text-align:center;
      box-shadow:0 10px 20px rgba(2,6,23,.18);
    }
    .amenity-block{
      border-radius:14px;
      background:rgba(15,23,42,.76);
      color:white;
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      font-weight:800;
      padding:12px 12px;
      text-align:center;
      box-shadow:0 10px 18px rgba(2,6,23,.14);
    }
    .amenity-card{
      border-radius:14px;
      background:rgba(255,255,255,.75);
      border:1px solid rgba(148,163,184,.35);
      padding:10px;
    }

    /* Scrollbar */
    ::-webkit-scrollbar{width:8px;}
    ::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:999px;}
    ::-webkit-scrollbar-track{background:transparent;}
  </style>
</head>

<body class="antialiased selection:bg-slate-200 selection:text-slate-900">

  <div class="ambient-bg">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>
  </div>

  <!-- Scarcity Banner -->
  <div class="fixed top-0 left-0 w-full z-50 bg-slate-900 text-white text-xs py-2 glass-panel border-none !bg-slate-900/90 backdrop-blur-md">
    <div class="marquee-container flex items-center">
      <div class="marquee-content px-4 font-medium tracking-widest uppercase">
        PR Card Applications Closing in 48 Hours // The Chosen 69: Only 8 Assets Available // International Waitlist: 4,102 Applicants //
        PR Card Applications Closing in 48 Hours // The Chosen 69: Only 8 Assets Available // International Waitlist: 4,102 Applicants //
      </div>
    </div>
  </div>

  <!-- Navigation -->
  <nav class="fixed top-12 left-0 w-full z-40 px-4 md:px-12 py-4">
    <div class="max-w-7xl mx-auto glass-panel rounded-full px-6 py-4 flex justify-between items-center shadow-lg">
      <div class="flex items-center gap-2 cursor-pointer" onclick="location.hash = '#/home'">
        <i data-lucide="gem" class="w-6 h-6 text-slate-800"></i>
        <span class="serif text-2xl font-semibold tracking-tight text-slate-900">
          AMADA<span class="font-light opacity-60">REALTY</span>
        </span>
      </div>

      <div class="hidden md:flex gap-8 text-sm font-medium tracking-wide text-slate-600">
        <a href="#/home" class="hover:text-slate-900 transition-colors">Home</a>
        <a href="#/city" class="hover:text-slate-900 transition-colors">The City</a>
        <a href="#/assets" class="hover:text-slate-900 transition-colors">Assets</a>
        <a href="#/pr-card" class="hover:text-slate-900 transition-colors">PR Card</a>
        <button onclick="openLegal('terms')" class="hover:text-slate-900 transition-colors">T&amp;C</button>
      </div>

      <button onclick="location.hash = '#/pr-card'"
              class="hidden md:flex items-center gap-2 bg-slate-900 text-white px-6 py-2.5 rounded-full text-xs font-semibold tracking-widest uppercase hover:bg-slate-800 transition-all shadow-lg hover:shadow-xl hover:scale-105 active:scale-95">
        Request PR Card
        <i data-lucide="arrow-right" class="w-3 h-3"></i>
      </button>

      <button class="md:hidden p-2" id="mobileMenuBtn" aria-label="Open menu">
        <i data-lucide="menu" class="w-6 h-6"></i>
      </button>
    </div>
  </nav>

  <!-- Mobile Menu -->
  <div id="mobileMenu" class="modal-overlay fixed inset-0 z-[60] flex items-start justify-center p-4 bg-slate-900/60 backdrop-blur-sm">
    <div class="modal-content w-full max-w-md glass-panel rounded-3xl overflow-hidden shadow-2xl mt-24">
      <div class="p-6 flex items-center justify-between border-b border-slate-200/60">
        <div class="flex items-center gap-2">
          <i data-lucide="gem" class="w-5 h-5 text-slate-800"></i>
          <span class="serif text-xl font-semibold">Menu</span>
        </div>
        <button onclick="closeMobileMenu()" class="w-10 h-10 rounded-full bg-white/60 flex items-center justify-center hover:bg-white transition-colors" aria-label="Close menu">
          <i data-lucide="x" class="w-5 h-5"></i>
        </button>
      </div>

      <div class="p-6 space-y-3 text-slate-700">
        <a class="block px-4 py-3 rounded-2xl bg-white/50 hover:bg-white transition" href="#/home" onclick="closeMobileMenu()">Home</a>
        <a class="block px-4 py-3 rounded-2xl bg-white/50 hover:bg-white transition" href="#/city" onclick="closeMobileMenu()">The City</a>
        <a class="block px-4 py-3 rounded-2xl bg-white/50 hover:bg-white transition" href="#/assets" onclick="closeMobileMenu()">Assets</a>
        <a class="block px-4 py-3 rounded-2xl bg-white/50 hover:bg-white transition" href="#/pr-card" onclick="closeMobileMenu()">PR Card</a>

        <div class="grid grid-cols-1 gap-2 pt-2">
          <button class="w-full text-left px-4 py-3 rounded-2xl bg-white/50 hover:bg-white transition" onclick="openLegal('privacy'); closeMobileMenu()">Privacy Policy</button>
          <button class="w-full text-left px-4 py-3 rounded-2xl bg-white/50 hover:bg-white transition" onclick="openLegal('terms'); closeMobileMenu()">Terms &amp; Conditions</button>
          <button class="w-full text-left px-4 py-3 rounded-2xl bg-white/50 hover:bg-white transition" onclick="openLegal('bylaws'); closeMobileMenu()">Estate Bylaws</button>
        </div>

        <button class="w-full flex items-center justify-center gap-2 mt-3 bg-slate-900 text-white px-6 py-3 rounded-2xl text-xs font-semibold tracking-widest uppercase hover:bg-slate-800 transition-all shadow-lg"
                onclick="location.hash='#/pr-card'; closeMobileMenu()">
          Request PR Card
          <i data-lucide="arrow-right" class="w-3 h-3"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- App -->
  <main id="app" class="pt-28">

    <!-- HOME -->
    <section class="page active" data-page="home" id="page-home">
      <header class="relative min-h-[90vh] flex flex-col justify-center items-center text-center px-4 pt-8">
        <div class="absolute inset-0 z-0 opacity-28 bg-[url('https://images.unsplash.com/photo-1600607686527-6fb886090705?q=80&w=2200&auto=format&fit=crop')] bg-cover bg-center mix-blend-overlay"></div>

        <div class="z-10 max-w-5xl mx-auto space-y-8 reveal active">
          <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full glass-panel border border-slate-200">
            <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
            <span class="text-xs font-semibold tracking-widest uppercase text-slate-600">The 9 Hectare Masterpiece</span>
          </div>

          <h1 class="text-6xl md:text-8xl lg:text-9xl font-light leading-none tracking-tighter text-slate-900">
            The World <br/> Within <span class="serif italic text-slate-500">Walls</span>
          </h1>

          <p class="text-lg md:text-2xl font-light text-slate-600 max-w-2xl mx-auto leading-relaxed">
            An enclave so exclusive, you don’t buy an asset. <br/>
            <span class="font-medium text-slate-900">You request a PR Card dossier.</span>
          </p>

          <div class="pt-8 flex flex-col md:flex-row gap-6 justify-center items-center">
            <div class="text-center px-8 py-4 glass-card rounded-2xl">
              <p class="text-xs text-slate-500 uppercase tracking-widest mb-1">Entry Requirement</p>
              <p class="text-2xl font-serif font-semibold text-slate-900">
                $1,000,000 USD <span class="text-xs font-sans font-normal text-slate-400">min liquid assets</span>
              </p>
            </div>

            <button onclick="location.hash='#/pr-card'"
                    class="group relative px-8 py-4 bg-slate-900 text-white rounded-full overflow-hidden shadow-2xl hover:shadow-slate-500/30 transition-all">
              <div class="absolute inset-0 w-full h-full bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000"></div>
              <span class="relative flex items-center gap-3 font-semibold tracking-widest text-sm uppercase">
                Request PR Card Dossier
                <i data-lucide="id-card" class="w-4 h-4"></i>
              </span>
            </button>
          </div>

          <div class="pt-6 flex flex-wrap justify-center gap-2 text-xs">
            <a href="#/city" class="px-4 py-2 rounded-full glass-panel border border-slate-200 hover:bg-white/80 transition">Explore The City</a>
            <a href="#/assets" class="px-4 py-2 rounded-full glass-panel border border-slate-200 hover:bg-white/80 transition">Select an Asset</a>
            <button onclick="openLegal('bylaws')" class="px-4 py-2 rounded-full glass-panel border border-slate-200 hover:bg-white/80 transition">Estate Bylaws</button>
          </div>
        </div>
      </header>

      <section class="py-12 border-y border-slate-200/50 glass-panel">
        <div class="max-w-7xl mx-auto px-6 flex flex-wrap justify-center md:justify-between items-center gap-8 opacity-60 grayscale hover:grayscale-0 transition-all duration-500">
          <span class="text-xl serif font-semibold">Architectural Digest</span>
          <span class="text-xl serif font-semibold">Forbes Real Estate</span>
          <span class="text-xl serif font-semibold">The Lagos Journal</span>
          <span class="text-xl serif font-semibold">Haute Living</span>
          <span class="text-xl serif font-semibold">Elite Traveler</span>
        </div>
      </section>

      <section class="py-24 px-4">
        <div class="max-w-5xl mx-auto text-center space-y-8 reveal">
          <h2 class="text-4xl md:text-6xl font-serif text-slate-900">Five Nations. One Address.</h2>
          <p class="text-lg md:text-xl text-slate-600 leading-relaxed font-light">
            A private-city estate where territories are districts, and amenities are curated like a luxury terminal.
            Select an Asset on the layout, preview its floor plan, then request your PR Card dossier.
          </p>

          <div class="grid grid-cols-2 md:grid-cols-4 gap-4 pt-8">
            <div class="glass-card p-6 rounded-3xl text-center">
              <h3 class="text-4xl font-bold text-slate-900 mb-2">69</h3>
              <p class="text-xs uppercase tracking-widest text-slate-500">Assets</p>
            </div>
            <div class="glass-card p-6 rounded-3xl text-center">
              <h3 class="text-4xl font-bold text-slate-900 mb-2">5</h3>
              <p class="text-xs uppercase tracking-widest text-slate-500">Territories</p>
            </div>
            <div class="glass-card p-6 rounded-3xl text-center">
              <h3 class="text-4xl font-bold text-slate-900 mb-2">1</h3>
              <p class="text-xs uppercase tracking-widest text-slate-500">Private City</p>
            </div>
            <div class="glass-card p-6 rounded-3xl text-center">
              <h3 class="text-4xl font-bold text-slate-900 mb-2">Top 1%</h3>
              <p class="text-xs uppercase tracking-widest text-slate-500">Neighbors</p>
            </div>
          </div>

          <div class="pt-6">
            <button onclick="location.hash='#/assets'"
                    class="inline-flex items-center gap-2 bg-slate-900 text-white px-8 py-4 rounded-full text-xs font-semibold tracking-widest uppercase hover:bg-slate-800 transition-all shadow-lg hover:shadow-xl hover:scale-105 active:scale-95">
              Enter the Assets Page
              <i data-lucide="arrow-right" class="w-3 h-3"></i>
            </button>
          </div>
        </div>
      </section>

      <footer class="bg-white border-t border-slate-200 py-14 px-4">
        <div class="max-w-7xl mx-auto text-center">
          <p class="text-[10px] text-slate-300 uppercase tracking-widest">© 2024 Amada Realty. All Rights Reserved.</p>
        </div>
      </footer>
    </section>

    <!-- CITY -->
    <section class="page" data-page="city" id="page-city">
      <div class="max-w-7xl mx-auto px-6 py-14">
        <div class="text-center mb-10 reveal">
          <span class="text-xs font-bold tracking-widest uppercase text-slate-400">The City</span>
          <h2 class="text-4xl md:text-6xl font-serif mt-2">Masterplan View</h2>
          <p class="text-lg text-slate-600 font-light max-w-3xl mx-auto mt-4">
            Click any zone to reveal access rules and policies.
          </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-5 gap-8 items-start">
          <!-- Map -->
          <div class="lg:col-span-3 glass-panel rounded-3xl p-6 reveal">
            <div class="flex items-start justify-between gap-4">
              <div>
                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/60 border border-slate-200">
                  <i data-lucide="map" class="w-4 h-4 text-slate-700"></i>
                  <span class="text-xs font-semibold tracking-widest uppercase text-slate-600">Interactive Map</span>
                </div>
                <h3 class="text-2xl md:text-3xl font-serif mt-3">City Zones</h3>
                <p class="text-sm text-slate-500 mt-2">Hover for tooltip. Click for details.</p>
              </div>

              <div class="flex gap-2 flex-wrap">
                <button onclick="setCityLayer('all')" class="px-4 py-2 rounded-full text-xs font-semibold tracking-widest uppercase border border-slate-200 bg-white/60 hover:bg-white transition">All</button>
                <button onclick="setCityLayer('territories')" class="px-4 py-2 rounded-full text-xs font-semibold tracking-widest uppercase border border-slate-200 bg-white/60 hover:bg-white transition">Territories</button>
                <button onclick="setCityLayer('amenities')" class="px-4 py-2 rounded-full text-xs font-semibold tracking-widest uppercase border border-slate-200 bg-white/60 hover:bg-white transition">Amenities</button>
              </div>
            </div>

            <div class="mt-6 relative rounded-3xl overflow-hidden border border-slate-200 bg-white/40 aspect-[5/7]">
              <!-- Optional: set CITY_MAP_IMAGE_URL in JS -->
              <img id="cityMapImg" src="" class="absolute inset-0 w-full h-full object-cover" alt="Amada City Masterplan" onerror="this.style.display='none';" />
              <svg id="cityMapSvg" class="absolute inset-0 w-full h-full" viewBox="0 0 1000 1400" preserveAspectRatio="none"></svg>
              <div id="cityTip" class="tip hidden">ZONE</div>

              <div id="cityMapFallback" class="absolute inset-0 flex items-center justify-center text-center p-10 text-slate-600">
                <div class="max-w-md">
                  <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/70 border border-slate-200 mb-4">
                    <i data-lucide="image" class="w-4 h-4"></i>
                    <span class="text-xs font-semibold tracking-widest uppercase">Map Image Optional</span>
                  </div>
                  <p class="text-sm leading-relaxed">
                    You can paste a masterplan image URL into <span class="font-semibold">CITY_MAP_IMAGE_URL</span> in the script.
                    Hotspots already work without the image.
                  </p>
                </div>
              </div>
            </div>

            <div class="mt-5 flex flex-wrap gap-2 text-xs text-slate-600">
              <span class="px-3 py-1 rounded-full border border-slate-200 bg-white/60 uppercase tracking-widest">Hover</span>
              <span class="px-3 py-1 rounded-full border border-slate-200 bg-white/60 uppercase tracking-widest">Click</span>
              <span class="px-3 py-1 rounded-full border border-slate-200 bg-white/60 uppercase tracking-widest">Policy-Driven</span>
            </div>
          </div>

          <!-- Details -->
          <div class="lg:col-span-2 space-y-6 reveal">
            <div class="glass-panel rounded-3xl p-6">
              <div class="flex items-start justify-between gap-4">
                <div>
                  <span class="text-xs font-bold tracking-widest uppercase text-slate-400">Selected Zone</span>
                  <h3 class="text-2xl font-serif mt-2" id="cityDetailTitle">New York Territory</h3>
                  <p class="text-sm text-slate-600 mt-2 leading-relaxed" id="cityDetailDesc">
                    Click a zone on the map to show its rules and access tiers.
                  </p>
                </div>
                <div class="w-12 h-12 rounded-2xl bg-white/60 border border-slate-200 flex items-center justify-center">
                  <i data-lucide="sparkles" class="w-6 h-6 text-slate-700" id="cityDetailIcon"></i>
                </div>
              </div>

              <div class="mt-6 grid grid-cols-2 gap-3">
                <div class="rounded-2xl bg-white/60 border border-slate-200 p-4">
                  <p class="text-[10px] uppercase tracking-widest text-slate-400 font-bold">Access</p>
                  <p class="text-sm text-slate-800 mt-1" id="cityDetailAccess">Residents + escorted guests</p>
                </div>
                <div class="rounded-2xl bg-white/60 border border-slate-200 p-4">
                  <p class="text-[10px] uppercase tracking-widest text-slate-400 font-bold">Hours</p>
                  <p class="text-sm text-slate-800 mt-1" id="cityDetailHours">Always</p>
                </div>
                <div class="rounded-2xl bg-white/60 border border-slate-200 p-4">
                  <p class="text-[10px] uppercase tracking-widest text-slate-400 font-bold">Noise</p>
                  <p class="text-sm text-slate-800 mt-1" id="cityDetailNoise">Low</p>
                </div>
                <div class="rounded-2xl bg-white/60 border border-slate-200 p-4">
                  <p class="text-[10px] uppercase tracking-widest text-slate-400 font-bold">Policy</p>
                  <button class="text-sm text-slate-800 mt-1 underline underline-offset-4 hover:text-slate-900" onclick="openLegal('bylaws')">View Estate Bylaws</button>
                </div>
              </div>

              <div class="mt-6 flex gap-3">
                <button id="cityCTA" onclick="location.hash='#/assets'" class="flex-1 bg-slate-900 text-white py-3 rounded-2xl font-bold uppercase tracking-widest hover:bg-slate-800 transition-colors shadow-lg text-xs">
                  Browse Assets
                </button>
                <button onclick="openLegal('privacy')" class="px-5 py-3 border border-slate-200 rounded-2xl font-bold uppercase tracking-widest hover:bg-white/70 transition-colors text-xs text-slate-700">
                  Privacy
                </button>
              </div>
            </div>

            <div class="glass-card rounded-3xl p-6">
              <h4 class="text-xl font-serif">City Statement</h4>
              <p class="text-sm text-slate-600 mt-3 leading-relaxed">
                The city is curated for controlled elegance—privacy-first, access-tiered, and built to preserve quiet luxury.
                Every policy exists to protect the value of the address.
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ASSETS -->
    <section class="page" data-page="assets" id="page-assets">
      <div class="max-w-7xl mx-auto px-6 py-14">
        <div class="text-center mb-10 reveal">
          <span class="text-xs font-bold tracking-widest uppercase text-slate-400">Assets</span>
          <h2 class="text-4xl md:text-6xl font-serif mt-2">Select an Asset on the Layout</h2>
          <p class="text-lg text-slate-600 font-light max-w-3xl mx-auto mt-4 leading-relaxed">
            No inventory lists. No search. Just the estate map — click an Asset, see its details and floor plan instantly.
          </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-5 gap-8 items-start">
          <!-- Estate Layout -->
          <div class="lg:col-span-3 glass-panel rounded-3xl p-6 reveal">
            <div class="flex items-start justify-between gap-4">
              <div>
                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/60 border border-slate-200">
                  <i data-lucide="layout-dashboard" class="w-4 h-4 text-slate-700"></i>
                  <span class="text-xs font-semibold tracking-widest uppercase text-slate-600">Estate Layout</span>
                </div>
                <h3 class="text-2xl md:text-3xl font-serif mt-3">Territories • Road • Amenities</h3>
                <p class="text-sm text-slate-500 mt-2">Click a unit square to select it.</p>
              </div>

              <button onclick="openLegal('bylaws')"
                      class="px-4 py-2 rounded-full text-xs font-semibold tracking-widest uppercase border border-slate-200 bg-white/60 hover:bg-white transition">
                Estate Bylaws
              </button>
            </div>

            <div class="mt-6 estate-canvas" style="height: 520px;">
              <div class="estate-inner"></div>

              <div class="absolute inset-0 p-4">
                <div class="w-full h-full grid gap-3" style="grid-template-columns: 1fr 18px .72fr;">
                  <!-- LEFT: Territories -->
                  <div class="space-y-3 overflow-auto pr-1" id="territoryBands"></div>

                  <!-- ROAD -->
                  <div class="estate-road"></div>

                  <!-- RIGHT: Amenities -->
                  <div class="overflow-auto">
                    <div class="amenity p-4 space-y-3">
                      <div class="amenity-pill">Shopping Mall & Offices</div>
                      <div class="amenity-block">Parking Lot & Helipad</div>

                      <div class="amenity-card">
                        <div class="text-[10px] uppercase tracking-widest text-slate-500 font-bold mb-2">School</div>
                        <div class="h-16 rounded-xl bg-slate-100 border border-slate-200 flex items-center justify-center text-slate-500 text-xs">
                          School Block
                        </div>
                      </div>

                      <div class="grid grid-cols-2 gap-3">
                        <div class="amenity-card text-center text-xs font-semibold text-slate-700">Park</div>
                        <div class="amenity-card text-center text-xs font-semibold text-slate-700">Dog Park</div>
                      </div>

                      <div class="amenity-card text-center">
                        <div class="text-xs font-semibold text-slate-800">Leisure Center</div>
                        <div class="mt-2 h-14 rounded-xl bg-slate-50 border border-slate-200 flex items-center justify-center text-slate-500 text-xs">
                          Activity Hub
                        </div>
                      </div>

                      <div class="amenity-card text-center">
                        <div class="text-xs font-semibold text-slate-800">Golf</div>
                        <div class="mt-2 h-12 rounded-xl bg-green-50 border border-green-200 flex items-center justify-center text-green-700 text-xs font-semibold">
                          Putting Green
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Tooltip -->
              <div id="unitTip" class="tip hidden">UNIT</div>
            </div>

            <div class="mt-5 flex flex-wrap gap-2 text-[11px] text-slate-600">
              <span class="px-3 py-1 rounded-full border border-slate-200 bg-white/60 uppercase tracking-widest">
                <span class="inline-block w-2 h-2 rounded-full bg-green-500 mr-2"></span>Available
              </span>
              <span class="px-3 py-1 rounded-full border border-slate-200 bg-white/60 uppercase tracking-widest">
                <span class="inline-block w-2 h-2 rounded-full bg-amber-500 mr-2"></span>Reserved
              </span>
              <span class="px-3 py-1 rounded-full border border-slate-200 bg-white/60 uppercase tracking-widest">
                <span class="inline-block w-2 h-2 rounded-full bg-slate-400 mr-2"></span>Waitlist
              </span>
              <span class="px-3 py-1 rounded-full border border-slate-200 bg-white/60 uppercase tracking-widest">
                Click = Select
              </span>
            </div>
          </div>

          <!-- Selected Unit -->
          <div class="lg:col-span-2 space-y-6 reveal">
            <div class="glass-panel rounded-3xl p-6">
              <div class="flex items-start justify-between gap-4">
                <div>
                  <span class="text-xs font-bold tracking-widest uppercase text-slate-400">Selected Asset</span>
                  <h3 class="text-2xl font-serif mt-2" id="selectedTitle">None selected</h3>
                  <p class="text-sm text-slate-600 mt-2 leading-relaxed" id="selectedDesc">
                    Click any unit square on the layout to preview details and floor plan.
                  </p>
                </div>
                <div class="w-12 h-12 rounded-2xl bg-white/60 border border-slate-200 flex items-center justify-center">
                  <i data-lucide="home" class="w-6 h-6 text-slate-700"></i>
                </div>
              </div>

              <div class="mt-6 grid grid-cols-2 gap-3" id="selectedStats">
                <div class="rounded-2xl bg-white/60 border border-slate-200 p-4">
                  <p class="text-[10px] uppercase tracking-widest text-slate-400 font-bold">Status</p>
                  <p class="text-sm text-slate-800 mt-1" id="statStatus">—</p>
                </div>
                <div class="rounded-2xl bg-white/60 border border-slate-200 p-4">
                  <p class="text-[10px] uppercase tracking-widest text-slate-400 font-bold">Price</p>
                  <p class="text-sm text-slate-800 mt-1" id="statPrice">—</p>
                </div>
                <div class="rounded-2xl bg-white/60 border border-slate-200 p-4">
                  <p class="text-[10px] uppercase tracking-widest text-slate-400 font-bold">Beds / Baths</p>
                  <p class="text-sm text-slate-800 mt-1" id="statBeds">—</p>
                </div>
                <div class="rounded-2xl bg-white/60 border border-slate-200 p-4">
                  <p class="text-[10px] uppercase tracking-widest text-slate-400 font-bold">Size</p>
                  <p class="text-sm text-slate-800 mt-1" id="statSize">—</p>
                </div>
              </div>

              <div class="mt-6 rounded-3xl border border-slate-200 bg-white/55 overflow-hidden">
                <div class="px-5 py-4 border-b border-slate-200/60 flex items-center justify-between gap-4">
                  <div>
                    <div class="text-[10px] uppercase tracking-widest text-slate-400 font-bold">Floor Plan Preview</div>
                    <div class="text-sm text-slate-700 mt-1" id="planLabel">Select an asset to generate a preview.</div>
                  </div>
                  <button onclick="openFloorplanModal()"
                          class="px-4 py-2 rounded-full text-xs font-semibold tracking-widest uppercase border border-slate-200 bg-white/70 hover:bg-white transition">
                    View
                  </button>
                </div>
                <div class="p-4 bg-white/50" id="floorplanPreview">
                  <div class="h-44 rounded-2xl border border-slate-200 bg-slate-50 flex items-center justify-center text-slate-400 text-sm">
                    No asset selected
                  </div>
                </div>
              </div>

              <div class="mt-6 flex gap-3">
                <button onclick="goPRCardWithSelection()"
                        class="flex-1 bg-slate-900 text-white py-3 rounded-2xl font-bold uppercase tracking-widest hover:bg-slate-800 transition-colors shadow-lg text-xs">
                  Request PR Card
                </button>
                <button onclick="downloadSelectedDossierPDF()"
                        class="px-5 py-3 border border-slate-200 rounded-2xl font-bold uppercase tracking-widest hover:bg-white/70 transition-colors text-xs text-slate-700">
                  Download PDF
                </button>
              </div>

              <p class="text-center text-[10px] text-slate-500 mt-4">
                By selecting an asset, you agree to the <button class="underline underline-offset-4 hover:text-slate-900" onclick="openLegal('terms')">Terms &amp; Conditions</button>.
              </p>
            </div>

            <div class="glass-card rounded-3xl p-6">
              <h4 class="text-xl font-serif">How this works</h4>
              <ol class="mt-3 space-y-2 text-sm text-slate-600">
                <li><span class="font-semibold text-slate-900">1)</span> Click any unit square on the estate layout.</li>
                <li><span class="font-semibold text-slate-900">2)</span> Review details + floor plan preview instantly.</li>
                <li><span class="font-semibold text-slate-900">3)</span> Request your PR Card dossier for viewing rights.</li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- PR CARD -->
    <section class="page" data-page="pr-card" id="page-pr-card">
      <section class="py-28 px-4 relative overflow-hidden">
        <div class="absolute inset-0 bg-slate-900 z-0"></div>
        <div class="absolute inset-0 z-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>

        <div class="relative z-10 max-w-4xl mx-auto text-center text-white space-y-8 reveal">
          <div class="inline-block border border-white/20 px-4 py-1 rounded-full backdrop-blur-md">
            <span class="text-xs font-bold tracking-[0.2em] uppercase">PR Card Access</span>
          </div>

          <h2 class="text-5xl md:text-7xl font-serif leading-none">Not For Everyone.<br/>Perhaps, For You.</h2>

          <p class="text-lg text-slate-300 font-light max-w-2xl mx-auto">
            Ownership at Amada Realty is by invitation or approved application only. Your PR Card dossier request triggers private review.
          </p>

          <div class="pt-10">
            <form id="prForm" onsubmit="handlePRSubmit(event)" class="glass-panel p-8 rounded-3xl max-w-lg mx-auto space-y-4 text-left relative overflow-hidden">
              <div id="formSuccess" class="absolute inset-0 bg-white z-20 hidden flex-col justify-center items-center text-center p-8">
                <div class="w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4">
                  <i data-lucide="check" class="w-8 h-8"></i>
                </div>
                <h4 class="text-2xl font-serif text-slate-900 mb-2">Request Received</h4>
                <p class="text-slate-500 text-sm">
                  Your dossier ID is <span class="font-semibold" id="dossierId">#AM-9281</span>.
                  Our private board will review your credentials within 48 hours.
                </p>
                <button type="button" onclick="closePRSuccess()" class="mt-6 text-xs font-bold uppercase tracking-widest text-slate-400 hover:text-slate-900">Close</button>
              </div>

              <div class="space-y-2">
                <label class="text-xs uppercase tracking-widest text-slate-900 font-bold">Full Name</label>
                <input required type="text" class="w-full bg-white/50 border border-slate-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-slate-900 text-slate-900 placeholder-slate-400" placeholder="e.g. Dr. Aliko...">
              </div>

              <div class="space-y-2">
                <label class="text-xs uppercase tracking-widest text-slate-900 font-bold">Net Worth Bracket</label>
                <select class="w-full bg-white/50 border border-slate-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-slate-900 text-slate-900">
                  <option>$1M - $5M</option>
                  <option>$5M - $20M</option>
                  <option>$20M+</option>
                </select>
              </div>

              <div class="space-y-2">
                <label class="text-xs uppercase tracking-widest text-slate-900 font-bold">Selected Asset</label>
                <input id="prUnit" type="text" readonly class="w-full bg-white/40 border border-slate-200 rounded-xl px-4 py-3 text-slate-900 placeholder-slate-400" placeholder="Select an asset on the Assets page">
              </div>

              <div class="space-y-2">
                <label class="text-xs uppercase tracking-widest text-slate-900 font-bold">Preferred Territory</label>
                <select id="prTerritory" class="w-full bg-white/50 border border-slate-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-slate-900 text-slate-900">
                  <option value="Naija">Naija</option>
                  <option value="Dubai">Dubai</option>
                  <option value="London">London</option>
                  <option value="NY">New York</option>
                  <option value="Canada">Canada</option>
                </select>
              </div>

              <button type="submit" class="w-full bg-slate-900 text-white py-4 rounded-xl font-bold uppercase tracking-widest hover:bg-slate-800 transition-colors shadow-lg mt-4 flex justify-center items-center gap-2">
                <span>Submit for Review</span>
                <i data-lucide="send" class="w-4 h-4"></i>
              </button>

              <p class="text-center text-[10px] text-slate-500 mt-2">
                By submitting, you agree to our
                <button type="button" class="underline underline-offset-4 hover:text-slate-900" onclick="openLegal('terms')">Terms</button>
                and
                <button type="button" class="underline underline-offset-4 hover:text-slate-900" onclick="openLegal('privacy')">Privacy Policy</button>.
              </p>
            </form>
          </div>
        </div>
      </section>
    </section>

  </main>

  <!-- Floorplan Modal (for selected unit) -->
  <div id="fp-modal" class="modal-overlay fixed inset-0 z-[70] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm" role="dialog" aria-modal="true" aria-label="Floorplan">
    <div class="modal-content w-full max-w-4xl bg-white rounded-3xl overflow-hidden shadow-2xl relative">
      <button onclick="closeFloorplanModal()" class="absolute top-4 right-4 z-10 w-10 h-10 bg-white/60 rounded-full flex items-center justify-center hover:bg-white transition-colors" aria-label="Close">
        <i data-lucide="x" class="w-5 h-5 text-slate-900"></i>
      </button>

      <div class="p-6 md:p-10 border-b border-slate-200 bg-white/70 backdrop-blur">
        <div class="flex items-start justify-between gap-6">
          <div>
            <span class="text-xs font-bold tracking-widest uppercase text-slate-400">Floor Plan</span>
            <h3 class="text-3xl md:text-4xl font-serif mt-2" id="fpTitle">Asset Floor Plan</h3>
            <p class="text-sm text-slate-600 mt-2" id="fpSubtitle">Preview generated from unit configuration.</p>
          </div>
          <button onclick="downloadSelectedDossierPDF()" class="px-4 py-2 rounded-full text-xs font-semibold tracking-widest uppercase border border-slate-200 bg-white hover:bg-slate-50 transition">
            Download PDF
          </button>
        </div>
      </div>

      <div class="p-6 md:p-10">
        <div class="rounded-3xl border border-slate-200 bg-slate-50 p-4" id="fpBody">
          <!-- injected -->
        </div>
      </div>
    </div>
  </div>

  <!-- Legal Modal -->
  <div id="legal-modal" class="modal-overlay fixed inset-0 z-[80] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm" role="dialog" aria-modal="true" aria-label="Legal documents">
    <div class="modal-content w-full max-w-5xl bg-white rounded-3xl overflow-hidden shadow-2xl relative">
      <button onclick="closeLegal()" class="absolute top-4 right-4 z-10 w-10 h-10 bg-white/60 rounded-full flex items-center justify-center hover:bg-white transition-colors" aria-label="Close">
        <i data-lucide="x" class="w-5 h-5 text-slate-900"></i>
      </button>

      <div class="p-6 md:p-10 border-b border-slate-200 bg-white/70 backdrop-blur">
        <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-6">
          <div>
            <span class="text-xs font-bold tracking-widest uppercase text-slate-400" id="legalKicker">Legal</span>
            <h3 class="text-3xl md:text-4xl font-serif mt-2" id="legalTitle">Privacy Policy</h3>
            <p class="text-sm text-slate-600 mt-2 max-w-3xl" id="legalSubtitle"></p>
          </div>

          <div class="flex gap-2 flex-wrap">
            <button class="px-4 py-2 rounded-full text-xs font-semibold tracking-widest uppercase border border-slate-200 bg-white hover:bg-slate-50 transition" onclick="openLegal('privacy')">Privacy</button>
            <button class="px-4 py-2 rounded-full text-xs font-semibold tracking-widest uppercase border border-slate-200 bg-white hover:bg-slate-50 transition" onclick="openLegal('terms')">T&amp;C</button>
            <button class="px-4 py-2 rounded-full text-xs font-semibold tracking-widest uppercase border border-slate-200 bg-white hover:bg-slate-50 transition" onclick="openLegal('bylaws')">Bylaws</button>
          </div>
        </div>
      </div>

      <div class="p-6 md:p-10 max-h-[70vh] overflow-auto">
        <div id="legalBody" class="text-slate-700 text-sm leading-relaxed"></div>
      </div>
    </div>
  </div>

  <script>
    // ---------------------------
    // Icons + Reveal
    // ---------------------------
    lucide.createIcons();

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('active'); });
    }, { threshold: 0.1 });

    document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

    // ---------------------------
    // SPA Router
    // ---------------------------
    function showPage(page, { scrollTop = true } = {}) {
      closeMobileMenu(true);
      closeLegal(true);
      closeFloorplanModal(true);

      document.querySelectorAll('.page[data-page]').forEach(p => p.classList.remove('active'));
      (document.querySelector(`.page[data-page="${page}"]`) || document.querySelector('.page[data-page="home"]'))?.classList.add('active');

      if (scrollTop) window.scrollTo({ top: 0, left: 0, behavior: 'instant' });

      lucide.createIcons();
      syncCityMapFallback();

      if (page === 'assets') {
        if (!estateRendered) renderEstateLayout();
        // pull selection into PR page inputs if already set
        hydratePRFormFromSelection();
      }

      if (page === 'pr-card') {
        hydratePRFormFromSelection();
      }

      if (page === 'city') {
        renderCityHotspots();
      }
    }

    function getRoutePage() {
      const h = location.hash || '#/home';
      if (!h.startsWith('#/')) return 'home';
      const page = h.replace('#/', '').trim();
      const allowed = new Set(['home','city','assets','pr-card']);
      return allowed.has(page) ? page : 'home';
    }

    window.addEventListener('hashchange', () => showPage(getRoutePage()));
    document.addEventListener('DOMContentLoaded', () => {
      if (!location.hash) location.hash = '#/home';
      showPage(getRoutePage(), { scrollTop: false });
    });

    // ---------------------------
    // Mobile Menu (scroll lock)
    // ---------------------------
    const mobileMenu = document.getElementById('mobileMenu');
    document.getElementById('mobileMenuBtn').addEventListener('click', () => {
      document.body.style.overflow = 'hidden';
      mobileMenu.classList.add('open');
      lucide.createIcons();
    });
    function closeMobileMenu(force=false){
      if (!mobileMenu.classList.contains('open') && !force) return;
      mobileMenu.classList.remove('open');
      document.body.style.overflow = '';
    }
    mobileMenu.addEventListener('click', (e) => { if(e.target === mobileMenu) closeMobileMenu(); });

    // ---------------------------
    // Data: 69 Assets (lightweight)
    // ---------------------------
    const territoryMeta = {
      ny:     { label:'New York Street', short:'NY',     basePrice:1200000, baseBeds:4, baseSize:4200 },
      canada: { label:'Canada Street',   short:'CA',     basePrice:1100000, baseBeds:4, baseSize:4600 },
      london: { label:'London Street',   short:'LDN',    basePrice:1500000, baseBeds:4, baseSize:3900 },
      dubai:  { label:'Dubai Street',    short:'DXB',    basePrice:1800000, baseBeds:5, baseSize:5200 },
      naija:  { label:'Naija Street',    short:'NG',     basePrice:2500000, baseBeds:6, baseSize:7200 }
    };

    const counts = { ny:13, canada:13, london:14, dubai:14, naija:15 }; // total 69
    let inventory = [];
    (function generateInventory(){
      const order = ['ny','canada','london','dubai','naija'];
      let idx = 1;
      for(const terr of order){
        for(let i=0;i<counts[terr];i++){
          const meta = territoryMeta[terr];
          const price = meta.basePrice + (Math.random()*350000) - 90000 + (terr==='naija' ? (Math.random()*250000) : 0);
          const beds = Math.max(1, Math.round(meta.baseBeds + (Math.random()*2 - 1)));
          const baths = (beds + (Math.random()>0.5?1:0)) + (Math.random()>0.75?0.5:0);
          const size = Math.round(meta.baseSize + (Math.random()*900 - 250));
          inventory.push({
            id: 'AM-' + String(idx).padStart(3,'0'),
            territory: terr,
            beds, baths,
            size,
            price: Math.round(price),
            status: 'waitlist'
          });
          idx++;
        }
      }

      const shuffled = [...inventory].sort(()=>Math.random()-0.5);
      const availableIds = new Set(shuffled.slice(0,8).map(x=>x.id));
      const reservedIds  = new Set(shuffled.slice(8,29).map(x=>x.id));
      inventory = inventory.map(p => ({
        ...p,
        status: availableIds.has(p.id) ? 'available' : reservedIds.has(p.id) ? 'reserved' : 'waitlist'
      }));
    })();

    function formatUSD(n){
      return '$' + Math.round(n).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }
    function statusLabel(s){
      return s === 'available' ? 'Available' : s === 'reserved' ? 'Reserved' : 'Waitlist';
    }
    function statusColor(s){
      if(s === 'available') return 'rgba(34,197,94,.85)';
      if(s === 'reserved') return 'rgba(245,158,11,.85)';
      return 'rgba(148,163,184,.85)';
    }

    // ---------------------------
    // Assets Page: Estate Layout
    // ---------------------------
    const MINI_COLS = 6;
    let estateRendered = false;
    let selectedUnit = null;
    let prevSelectedId = null;

    function groupUnitsByTerritory(){
      const groups = { ny:[], canada:[], london:[], dubai:[], naija:[] };
      inventory.forEach(u => groups[u.territory].push(u));
      return groups;
    }

    function renderEstateLayout(){
      const bandsEl = document.getElementById('territoryBands');
      if(!bandsEl) return;

      const groups = groupUnitsByTerritory();
      const order = ['ny','canada','london','dubai','naija'];

      bandsEl.innerHTML = order.map(key => {
        const list = groups[key];
        const label = territoryMeta[key].label;

        const units = list.map(u => `
          <button class="unit"
                  id="unit-${u.id}"
                  data-unit="${u.id}"
                  style="background:${statusColor(u.status)}"
                  aria-label="${u.id}"
                  title="${u.id}">
          </button>
        `).join('');

        return `
          <div class="band">
            <div class="band-title">${label}</div>
            <div class="lots">
              <div class="grid grid-cols-6 gap-2" style="grid-auto-rows:24px;">
                ${units}
              </div>
            </div>
          </div>
        `;
      }).join('');

      wireEstateUnitEvents();
      estateRendered = true;

      // restore selection (if exists)
      const saved = sessionStorage.getItem('amada_selected_unit');
      if (saved) selectUnit(saved, { silentScroll: true });
    }

    function wireEstateUnitEvents(){
      const tip = document.getElementById('unitTip');
      const canvas = document.querySelector('.estate-canvas');
      if(!canvas) return;

      document.querySelectorAll('[data-unit]').forEach(btn => {
        const unitId = btn.getAttribute('data-unit');

        btn.addEventListener('mouseenter', () => {
          const unit = inventory.find(x => x.id === unitId);
          if(!unit || !tip) return;
          tip.classList.remove('hidden');
          tip.textContent = `${unit.id} • ${territoryMeta[unit.territory].short} • ${statusLabel(unit.status)}`;
        });

        btn.addEventListener('mousemove', (e) => {
          if(!tip) return;
          const rect = canvas.getBoundingClientRect();
          tip.style.left = (e.clientX - rect.left + 12) + 'px';
          tip.style.top  = (e.clientY - rect.top  + 12) + 'px';
        });

        btn.addEventListener('mouseleave', () => {
          tip?.classList.add('hidden');
        });

        btn.addEventListener('click', () => selectUnit(unitId));
      });
    }

    function selectUnit(unitId, { silentScroll = false } = {}){
      const unit = inventory.find(x => x.id === unitId);
      if(!unit) return;
      selectedUnit = unit;
      sessionStorage.setItem('amada_selected_unit', unit.id);

      // highlight
      if (prevSelectedId) {
        document.getElementById('unit-' + prevSelectedId)?.classList.remove('ring-2','ring-slate-900');
      }
      document.getElementById('unit-' + unit.id)?.classList.add('ring-2','ring-slate-900');
      prevSelectedId = unit.id;

      // update UI
      const terrLabel = territoryMeta[unit.territory].label;
      document.getElementById('selectedTitle').innerText = `${unit.id} • ${terrLabel}`;
      document.getElementById('selectedDesc').innerText =
        `A ${unit.beds}-bed residence in ${terrLabel}. Status: ${statusLabel(unit.status)}.`;

      document.getElementById('statStatus').innerText = statusLabel(unit.status);
      document.getElementById('statPrice').innerText = formatUSD(unit.price);
      document.getElementById('statBeds').innerText  = `${unit.beds} / ${unit.baths}`;
      document.getElementById('statSize').innerText  = `${unit.size.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")} ft²`;

      document.getElementById('planLabel').innerText = `Generated preview for ${unit.id} (${unit.beds} bedrooms).`;

      // floorplan preview
      const preview = document.getElementById('floorplanPreview');
      preview.innerHTML = buildFloorplanSVG(unit, { compact: true });

      // hydrate PR form fields if on PR page later
      hydratePRFormFromSelection();

      if(!silentScroll){
        // keep UX crisp on mobile: scroll the details into view
        if (window.innerWidth < 1024) {
          document.getElementById('selectedTitle').scrollIntoView({ behavior:'smooth', block:'start' });
        }
      }

      lucide.createIcons();
    }

    // ---------------------------
    // Floorplan generation (lightweight SVG)
    // ---------------------------
    function buildFloorplanSVG(unit, { compact = false } = {}){
      const beds = unit.beds;
      const w = compact ? 520 : 760;
      const h = compact ? 240 : 360;

      const roomCount = Math.min(6, Math.max(3, beds)); // 3..6 rooms
      const cols = 2;
      const rows = Math.ceil((roomCount + 2) / cols); // + living/kitchen
      const pad = 14;
      const gap = 10;

      const usableW = w - pad*2;
      const usableH = h - pad*2;
      const cellW = (usableW - gap*(cols-1)) / cols;
      const cellH = (usableH - gap*(rows-1)) / rows;

      const labels = ["Living", "Kitchen", ...Array.from({length: roomCount}, (_,i)=>`Bed ${i+1}`)];
      const rects = [];

      for(let i=0;i<labels.length;i++){
        const r = Math.floor(i/cols);
        const c = i%cols;
        const x = pad + c*(cellW+gap);
        const y = pad + r*(cellH+gap);

        // slightly different fills for “depth”
        const isCore = i < 2;
        const fill = isCore ? "rgba(2,132,199,.10)" : "rgba(15,23,42,.05)";
        const stroke = "rgba(100,116,139,.45)";
        rects.push(`
          <g>
            <rect x="${x}" y="${y}" width="${cellW}" height="${cellH}" rx="14"
                  fill="${fill}" stroke="${stroke}" stroke-width="1.2"/>
            <text x="${x+14}" y="${y+22}" font-size="12" fill="rgba(15,23,42,.78)" font-weight="700" letter-spacing=".08em">
              ${labels[i].toUpperCase()}
            </text>
            <line x1="${x+14}" y1="${y+30}" x2="${x+cellW-14}" y2="${y+30}" stroke="rgba(15,23,42,.08)" />
          </g>
        `);
      }

      return `
        <svg viewBox="0 0 ${w} ${h}" width="100%" height="${compact ? 180 : 280}" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Floorplan">
          <defs>
            <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="rgba(255,255,255,.9)"/>
              <stop offset="1" stop-color="rgba(241,245,249,.9)"/>
            </linearGradient>
            <linearGradient id="edge" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0" stop-color="rgba(255,255,255,.7)"/>
              <stop offset="1" stop-color="rgba(2,6,23,.04)"/>
            </linearGradient>
          </defs>

          <rect x="6" y="6" width="${w-12}" height="${h-12}" rx="22" fill="url(#bg)" stroke="rgba(148,163,184,.55)" />
          <rect x="12" y="12" width="${w-24}" height="${h-24}" rx="18" fill="none" stroke="url(#edge)" />

          <text x="18" y="26" font-size="12" fill="rgba(100,116,139,.8)" font-weight="800" letter-spacing=".22em">
            ${unit.id} • ${territoryMeta[unit.territory].short} • ${beds} BED
          </text>

          ${rects.join("")}

          <text x="${w-18}" y="${h-16}" text-anchor="end" font-size="10" fill="rgba(100,116,139,.75)" font-weight="700" letter-spacing=".18em">
            PREVIEW • NOT TO SCALE
          </text>
        </svg>
      `;
    }

    // ---------------------------
    // Floorplan Modal controls
    // ---------------------------
    function openFloorplanModal(){
      if(!selectedUnit){
        // gentle feedback without extra UI
        return;
      }
      document.body.style.overflow = 'hidden';
      document.getElementById('fpTitle').innerText = `${selectedUnit.id} • Floor Plan`;
      document.getElementById('fpSubtitle').innerText = `${territoryMeta[selectedUnit.territory].label} • ${selectedUnit.beds} beds • ${selectedUnit.size.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")} ft²`;
      document.getElementById('fpBody').innerHTML = buildFloorplanSVG(selectedUnit, { compact:false });
      document.getElementById('fp-modal').classList.add('open');
      lucide.createIcons();
    }

    function closeFloorplanModal(force=false){
      const m = document.getElementById('fp-modal');
      if(!m.classList.contains('open') && !force) return;
      m.classList.remove('open');
      document.body.style.overflow = '';
    }

    document.getElementById('fp-modal').addEventListener('click', (e) => {
      if (e.target.id === 'fp-modal') closeFloorplanModal();
    });

    // ---------------------------
    // PR Card: prefill from selection
    // ---------------------------
    function hydratePRFormFromSelection(){
      const prUnit = document.getElementById('prUnit');
      const prTerr = document.getElementById('prTerritory');
      if(!prUnit || !prTerr) return;

      const saved = sessionStorage.getItem('amada_selected_unit');
      const unit = saved ? inventory.find(x => x.id === saved) : null;

      if(unit){
        prUnit.value = unit.id;
        const map = { ny:'NY', dubai:'Dubai', london:'London', canada:'Canada', naija:'Naija' };
        prTerr.value = map[unit.territory] || 'Naija';
      } else {
        prUnit.value = '';
      }
    }

    function goPRCardWithSelection(){
      location.hash = '#/pr-card';
      setTimeout(hydratePRFormFromSelection, 80);
    }

    // ---------------------------
    // PR Card submit
    // ---------------------------
    function makeDossierId(){
      const n = Math.floor(1000 + Math.random()*8999);
      return '#AM-' + n;
    }

    function closePRSuccess(){
      const fs = document.getElementById('formSuccess');
      fs.classList.add('hidden');
      fs.classList.remove('flex');
      document.getElementById('prForm').reset();
      hydratePRFormFromSelection();
    }

    function handlePRSubmit(e){
      e.preventDefault();
      const btn = e.target.querySelector('button[type="submit"]');
      const originalText = btn.innerHTML;

      btn.innerHTML = '<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Encrypting...';
      btn.disabled = true;

      setTimeout(() => {
        document.getElementById('dossierId').innerText = makeDossierId();
        const fs = document.getElementById('formSuccess');
        fs.classList.remove('hidden');
        fs.classList.add('flex');
        btn.innerHTML = originalText;
        btn.disabled = false;
        lucide.createIcons();
      }, 1200);
    }

    // ---------------------------
    // Legal docs (scroll lock)
    // ---------------------------
    const legalDocs = {
      privacy: {
        kicker: 'Legal',
        title: 'Privacy Policy',
        subtitle: 'How Amada Realty collects, uses, stores, and protects information submitted through the estate website.',
        body: `
          <h4 style="font-weight:800; margin-top:0;">1. Scope</h4>
          <p>This policy covers data submitted through Amada Realty pages, PR Card requests, and concierge communications.</p>

          <h4 style="font-weight:800;">2. What We Collect</h4>
          <ul style="margin-left:18px; list-style:disc;">
            <li><strong>Identity & contact</strong>: name and contact details submitted by you.</li>
            <li><strong>Application context</strong>: net worth bracket, selected asset, territory preference.</li>
            <li><strong>Usage</strong>: basic site analytics to improve experience.</li>
          </ul>

          <h4 style="font-weight:800;">3. Confidentiality</h4>
          <p>Amada Realty is invitation-grade. Submitted information is reviewed under need-to-know access and used only for eligibility and concierge follow-up.</p>

          <h4 style="font-weight:800;">4. Sharing</h4>
          <p>We do not sell your data. Limited sharing may occur with vetted service partners strictly for operational needs, under confidentiality obligations.</p>

          <h4 style="font-weight:800;">5. Contact</h4>
          <p>Concierge: <strong>concierge@amadarealty.com</strong></p>
        `
      },
      terms: {
        kicker: 'Legal',
        title: 'Terms & Conditions',
        subtitle: 'Website use, PR Card eligibility, confidentiality rules, and purchase-access conditions.',
        body: `
          <h4 style="font-weight:800; margin-top:0;">1. Private Estate Notice</h4>
          <p>Amada Realty is invitation-grade. Access to floorplans, tours, and purchase rights may be restricted at any time.</p>

          <h4 style="font-weight:800;">2. PR Card Requests</h4>
          <ul style="margin-left:18px; list-style:disc;">
            <li>Submitting a PR Card request does not guarantee approval or viewing rights.</li>
            <li>We may require proof of funds and/or references before private disclosures.</li>
          </ul>

          <h4 style="font-weight:800;">3. Confidentiality</h4>
          <p>Layouts, floorplans, internal policies, and pricing details are confidential. You agree not to distribute proprietary materials.</p>

          <h4 style="font-weight:800;">4. Availability</h4>
          <p>All status labels are indicative and may change without notice.</p>
        `
      },
      bylaws: {
        kicker: 'Estate Governance',
        title: 'Estate Bylaws',
        subtitle: 'Rules that protect silence, safety, aesthetics, and resident privacy.',
        body: `
          <h4 style="font-weight:800; margin-top:0;">1. Quiet Luxury Standard</h4>
          <ul style="margin-left:18px; list-style:disc;">
            <li>Quiet Hours: <strong>22:00 – 07:00</strong></li>
            <li>Restricted outdoor noise events without approval.</li>
          </ul>

          <h4 style="font-weight:800;">2. Visitor Policy</h4>
          <ul style="margin-left:18px; list-style:disc;">
            <li>Guests must be registered by residents.</li>
            <li>Large gatherings require prior approval.</li>
          </ul>

          <h4 style="font-weight:800;">3. Aesthetics</h4>
          <p>Exterior changes require architectural review to preserve territory identity.</p>

          <h4 style="font-weight:800;">4. Security</h4>
          <p>Controlled entry, authorized access, and protected routes are enforced to preserve resident privacy.</p>
        `
      }
    };

    function openLegal(kind){
      document.body.style.overflow = 'hidden';
      const doc = legalDocs[kind] || legalDocs.privacy;

      document.getElementById('legalKicker').innerText = doc.kicker;
      document.getElementById('legalTitle').innerText = doc.title;
      document.getElementById('legalSubtitle').innerText = doc.subtitle;
      document.getElementById('legalBody').innerHTML = doc.body;

      document.getElementById('legal-modal').classList.add('open');
      lucide.createIcons();
    }

    function closeLegal(force=false){
      const m = document.getElementById('legal-modal');
      if(!m.classList.contains('open') && !force) return;
      m.classList.remove('open');
      document.body.style.overflow = '';
    }

    document.getElementById('legal-modal').addEventListener('click', (e) => {
      if (e.target.id === 'legal-modal') closeLegal();
    });

    // ---------------------------
    // City Map (optional background + hotspots)
    // ---------------------------
    const CITY_MAP_IMAGE_URL = ""; // optional: paste URL to your masterplan image
    let currentCityLayer = "all";

    const cityZones = {
      ny:     { type:"territory", title:"New York Territory", icon:"building-2", access:"Residents + escorted guests", hours:"Always", noise:"Medium", desc:"Industrial luxury district with controlled terraces and quiet prestige." },
      canada: { type:"territory", title:"Canada Territory",   icon:"mountain",   access:"Residents + escorted guests", hours:"Always", noise:"Low",    desc:"Timber calm district designed for retreat and family privacy." },
      london: { type:"territory", title:"London Territory",   icon:"umbrella",   access:"Residents + escorted guests", hours:"Always", noise:"Low",    desc:"Regency calm district with garden etiquette and discreet arrivals." },
      dubai:  { type:"territory", title:"Dubai Territory",    icon:"sun",        access:"Residents + escorted guests", hours:"Always", noise:"Low",    desc:"Modernist villas and controlled pool privacy zoning." },
      naija:  { type:"territory", title:"Naija Territory",    icon:"crown",      access:"Residents + escorted guests", hours:"Always", noise:"Medium", desc:"Flagship district with sovereign-scale residences and hosting zones." },

      mall:   { type:"amenity", title:"Shopping Mall & Offices", icon:"shopping-bag", access:"Residents + invited guests", hours:"08:00–22:00", noise:"Low", desc:"Curated retail + private offices, controlled access." },
      heli:   { type:"amenity", title:"Parking Lot & Helipad",   icon:"plane",        access:"Authorized entry",         hours:"06:00–22:00", noise:"Controlled", desc:"Valet pockets, service routing, executive arrivals." },
      school: { type:"amenity", title:"School",                  icon:"graduation-cap",access:"Residents only",         hours:"07:30–16:00", noise:"Low", desc:"International academy corridor, controlled parent access." },
      park:   { type:"amenity", title:"Park & Dog Park",         icon:"trees",        access:"Residents + guests",      hours:"06:00–21:00", noise:"Low", desc:"Green breathing space + dog zone, strict cleanliness policy." },
      leisure:{ type:"amenity", title:"Leisure Center",          icon:"sparkles",     access:"Residents + guests",      hours:"08:00–23:00", noise:"Low", desc:"Gym + lounge — curated social behavior." },
      golf:   { type:"amenity", title:"Golf",                    icon:"flag",         access:"Residents + guests",      hours:"06:00–19:00", noise:"Low", desc:"Putting/practice — quiet sport, quiet prestige." }
    };

    const cityHotspots = [
      { key:"ny",     layer:"territories", x: 90,  y: 110, w: 520, h: 170 },
      { key:"canada", layer:"territories", x: 90,  y: 315, w: 520, h: 170 },
      { key:"london", layer:"territories", x: 90,  y: 520, w: 520, h: 170 },
      { key:"dubai",  layer:"territories", x: 90,  y: 725, w: 520, h: 170 },
      { key:"naija",  layer:"territories", x: 90,  y: 930, w: 520, h: 170 },

      { key:"mall",   layer:"amenities",  x: 705, y: 120, w: 250, h: 140 },
      { key:"heli",   layer:"amenities",  x: 705, y: 290, w: 250, h: 120 },
      { key:"school", layer:"amenities",  x: 705, y: 440, w: 250, h: 140 },
      { key:"park",   layer:"amenities",  x: 705, y: 610, w: 250, h: 140 },
      { key:"leisure",layer:"amenities",  x: 705, y: 780, w: 250, h: 150 },
      { key:"golf",   layer:"amenities",  x: 705, y: 960, w: 250, h: 140 }
    ];

    function syncCityMapFallback(){
      const img = document.getElementById('cityMapImg');
      const fallback = document.getElementById('cityMapFallback');
      if(!img || !fallback) return;

      if (CITY_MAP_IMAGE_URL && CITY_MAP_IMAGE_URL.trim().length > 0) {
        img.src = CITY_MAP_IMAGE_URL.trim();
        fallback.style.display = 'none';
      } else {
        fallback.style.display = 'flex';
      }
    }

    function setCityLayer(layer){
      currentCityLayer = layer;
      renderCityHotspots();
    }

    function setCityDetails(key){
      const z = cityZones[key];
      if(!z) return;

      document.getElementById('cityDetailTitle').innerText = z.title;
      document.getElementById('cityDetailDesc').innerText  = z.desc;
      document.getElementById('cityDetailAccess').innerText= z.access;
      document.getElementById('cityDetailHours').innerText = z.hours;
      document.getElementById('cityDetailNoise').innerText = z.noise;

      const iconEl = document.getElementById('cityDetailIcon');
      iconEl.setAttribute('data-lucide', z.icon);

      const cta = document.getElementById('cityCTA');
      cta.onclick = () => location.hash = '#/assets';

      lucide.createIcons();
    }

    function renderCityHotspots(){
      const svg = document.getElementById('cityMapSvg');
      const tip = document.getElementById('cityTip');
      if(!svg) return;

      syncCityMapFallback();
      const visible = cityHotspots.filter(h => currentCityLayer === 'all' ? true : h.layer === currentCityLayer);

      svg.innerHTML = visible.map(h => `
        <rect data-zone="${h.key}"
              x="${h.x}" y="${h.y}" width="${h.w}" height="${h.h}"
              rx="22" ry="22"
              fill="rgba(255,255,255,0.001)"
              stroke="rgba(255,255,255,0.0)"
              stroke-width="2"
              style="cursor:pointer;"></rect>
      `).join('');

      svg.querySelectorAll('rect[data-zone]').forEach(r => {
        const key = r.getAttribute('data-zone');

        r.addEventListener('mouseenter', () => {
          r.setAttribute('fill', 'rgba(255,255,255,0.08)');
          r.setAttribute('stroke','rgba(255,255,255,0.35)');
          if(tip){
            tip.classList.remove('hidden');
            tip.textContent = cityZones[key]?.title || key.toUpperCase();
          }
        });

        r.addEventListener('mousemove', (e) => {
          if(!tip) return;
          const wrap = svg.getBoundingClientRect();
          tip.style.left = (e.clientX - wrap.left + 14) + 'px';
          tip.style.top  = (e.clientY - wrap.top + 14) + 'px';
        });

        r.addEventListener('mouseleave', () => {
          r.setAttribute('fill', 'rgba(255,255,255,0.001)');
          r.setAttribute('stroke','rgba(255,255,255,0.0)');
          tip?.classList.add('hidden');
        });

        r.addEventListener('click', () => setCityDetails(key));
      });

      setCityDetails('ny');
      lucide.createIcons();
    }

    // ---------------------------
    // PDF (print-to-pdf window) for selected unit
    // ---------------------------
    function openPrintWindow(htmlTitle, htmlBody){
      const w = window.open('', '_blank', 'width=900,height=1100');
      if(!w) return;

      const html = `<!doctype html><html><head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title>${htmlTitle}</title>
        <style>
          body{font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; padding:40px; color:#0f172a;}
          h1{font-family: Georgia, serif; margin:0 0 8px 0; font-size:34px;}
          h2{margin:0 0 18px 0; font-weight:600; color:#334155;}
          .pill{display:inline-block; padding:6px 12px; border:1px solid #cbd5e1; border-radius:999px; font-size:12px; letter-spacing:.18em; text-transform:uppercase; color:#475569; margin:8px 8px 0 0;}
          .box{border:1px solid #e2e8f0; border-radius:18px; padding:18px; margin-top:18px;}
          .grid{display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:14px;}
          .k{font-size:10px; letter-spacing:.2em; text-transform:uppercase; color:#64748b; font-weight:800;}
          .v{font-size:14px; margin-top:4px;}
          .foot{margin-top:28px; font-size:12px; color:#64748b;}
          .brand{margin-top:26px; font-size:11px; letter-spacing:.2em; text-transform:uppercase; color:#94a3b8;}
          svg{max-width:100%; height:auto;}
        </style>
      </head><body>
        ${htmlBody}
        <div class="foot">Tip: Use Print → “Save as PDF”.</div>
        <div class="brand">AMADA REALTY • Confidential Dossier</div>
      </body></html>`;

      w.document.open();
      w.document.write(html);
      w.document.close();

      w.onload = () => setTimeout(() => { try { w.focus(); w.print(); } catch(e){} }, 350);
      setTimeout(() => { try { w.focus(); w.print(); } catch(e){} }, 900);
    }

    function downloadSelectedDossierPDF(){
      if(!selectedUnit) return;

      const terrLabel = territoryMeta[selectedUnit.territory].label;

      const body = `
        <div class="pill">Asset Dossier</div>
        <h1>${selectedUnit.id} • ${terrLabel}</h1>
        <h2>${statusLabel(selectedUnit.status)} • ${formatUSD(selectedUnit.price)}</h2>

        <div class="box">
          <div class="grid">
            <div><div class="k">Territory</div><div class="v">${terrLabel}</div></div>
            <div><div class="k">Status</div><div class="v">${statusLabel(selectedUnit.status)}</div></div>
            <div><div class="k">Beds / Baths</div><div class="v">${selectedUnit.beds} / ${selectedUnit.baths}</div></div>
            <div><div class="k">Size</div><div class="v">${selectedUnit.size.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ",")} ft²</div></div>
          </div>
        </div>

        <div class="box">
          <div class="k">Floor Plan Preview</div>
          <div class="v" style="margin-top:12px;">${buildFloorplanSVG(selectedUnit, { compact:false })}</div>
        </div>

        <div class="box">
          <div class="k">Confidentiality</div>
          <div class="v" style="line-height:1.7;">
            This dossier is invitation-grade. Distribution is prohibited. Viewing rights and purchase access are subject to PR Card approval.
          </div>
        </div>
      `;

      openPrintWindow(`${selectedUnit.id} Dossier`, body);
    }

    // ---------------------------
    // Init
    // ---------------------------
    document.addEventListener('DOMContentLoaded', () => {
      syncCityMapFallback();
      renderCityHotspots();
      // defer heavy DOM until Assets page is opened
      lucide.createIcons();
    });

    // ESC close
    window.addEventListener('keydown', (e)=>{
      if(e.key === 'Escape'){
        closeMobileMenu(true);
        closeLegal(true);
        closeFloorplanModal(true);
      }
    });
  </script>
</body>
</html>
